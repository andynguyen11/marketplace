webpackJsonp([6],{"./app/scripts/containers/editProject/budget.jsx":function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a("./node_modules/react-router/es6/index.js"),r=a("./app/scripts/utils/formUtils.js"),i=a("./app/scripts/utils/elementUtils.js"),n=a("./app/scripts/containers/editProject/editProject.js"),c=a("./app/scripts/config.js"),p=a("./app/scripts/components/loader/loader.jsx"),l=s(p),d=a("./app/scripts/containers/editProject/progressBar.jsx"),u=s(d),m=a("./app/scripts/components/forms/formFields.js"),y=a("./app/scripts/components/button/button.jsx"),f=s(y),g=a("./app/scripts/components/errors/errors.js"),h=a("./app/scripts/components/modal/modal.jsx"),b=React.createClass({displayName:"ProjectBudget",propTypes:{user:React.PropTypes.object,params:React.PropTypes.object.isRequired,router:React.PropTypes.object,location:React.PropTypes.object.isRequired},getInitialState:function(){var e=this.props,t=e.user,a=e.params.projectId,s=(0,n.createEmptyProjectState)(t,a);return Object.assign({},s,{companyModalOpen:!1})},formFields:function(e){var t=this,a=e;return{compensationType:{name:"compensationType",label:"Budget type (select one)",value:function(){var e=a.estimated_cash,t=a.estimated_equity_percentage,s=a.mix,o="",r=t?t:"";return e&&r.length?o=s?"cash-and-equity":"cash-or-equity":(e&&(o="cash"),r.length&&(o="equity")),o}(),options:[{label:"Cash only",id:"cash"},{label:"Equity only",id:"equity"},{label:"Cash or equity",id:"cash-or-equity"},{label:"Cash + equity mix",id:"cash-and-equity"}],error:!1,validator:function(e){var a=t.state.formFields,s=r.FormUtils.checks.isRequired(e);return s||(a.compensationType.error="Please tell us how you'd like to compensate developers.",t.setState({formFields:a})),s},onChange:function(e){var a=t.state,s=a.budgetType,o=a.data,r=a.formFields,i=s,n=!1;switch(e){case"cash-or-equity":i="cash-equity",o.mix=!1;break;case"cash-and-equity":i="cash-equity",o.mix=!0;break;case"cash":i="cash",o.mix=!1,r.equity.onChange("");break;case"equity":i="equity",o.mix=!1,r.cash.onChange("")}o.company||"cash"===e||(n=!0),r.compensationType.value=e,r.compensationType.error=!1,t.setState({budgetType:i,data:o,formFields:r,formError:!1,companyModalOpen:n})}},cash:{name:"cash",label:"Cash budget",value:a.estimated_cash&&a.estimated_cash+""||"",error:!1,validator:function(e){var a=t.state,s=a.budgetType,o=a.formFields,r="string"==typeof e?e.replace(/,/g,""):e,i=parseInt(r),n=e.toString().match(/^\d*?\d*$/),c="cash"!==s&&"cash-equity"!==s||"number"==typeof i&&i>0&&n;return c||(o.cash.error="Please enter a cash offer.",t.setState({formFields:o})),c},onChange:function(e){var a=t.state,s=a.data,o=a.formFields;s.estimated_cash=e,o.cash.value=e,o.cash.error=!1,t.setState({data:s,formFields:o,formError:!1})}},equity:{name:"equity",label:"Equity budget",value:a.estimated_equity_percentage&&a.estimated_equity_percentage+""||"",error:!1,validator:function(e){var a=t.state,s=a.budgetType,o=a.formFields,r=parseFloat(e),i=e?e.toString().match(/^\d*\.?\d*$/):"",n="equity"!==s&&"cash-equity"!==s||"number"==typeof r&&r>0&&r<100&&i;return n||(o.equity.error="Please enter an equity offer.",t.setState({formFields:o})),n},onChange:function(e){var a=t.state,s=a.data,o=a.formFields;s.estimated_equity_percentage=e,o.equity.value=e,o.equity.error=!1,t.setState({data:s,formFields:o,formError:!1})}}}},componentWillMount:function(){var e=this,t=this.props,a=t.router,s=t.location.state,o=t.params.projectId;if(o)(0,n.getProjectData)(o,function(t){var a=Object.assign({},t),s=e.formFields(a),o="";o="cash-or-equity"===s.compensationType.value||"cash-and-equity"===s.compensationType.value?"cash-equity":s.compensationType.value,e.setState({data:a,budgetType:o,formFields:s,isLoading:!1},e.setCompanyState)},function(t,a){console.error(t),e.setState({isSending:!1,apiError:a.text})});else if(s&&s.data){var r=Object.assign({},s.data),i=this.formFields(r),c="";c="cash-or-equity"===i.compensationType.value||"cash-and-equity"===i.compensationType.value?"cash-equity":i.compensationType.value,this.setState({data:r,budgetType:c,formFields:i,isLoading:!1},this.setCompanyState)}else a.replace("/")},componentDidMount:function(){(0,i.scrollToTop)()},setCompanyState:function(){var e=this.state,t=e.data.company,a=e.formFields;t||a.compensationType.onChange("cash")},submitBudget:function(){var e=this,t=this.state,a=t.data,s=t.formFields;r.FormUtils.validateForm(s,function(t){if(e.setState({formError:!t,apiError:!1}),t){e.setState({isSending:!0});var s=Object.assign({},a);delete s.project_image,s.published=!0,(0,n.submitProjectData)(s,function(t){e.goToStep("details",t)},function(t,a){console.error(t),e.setState({isSending:!1,apiError:a.text})})}})},goToStep:function(e,t){var a=this.props.params.projectId;o.browserHistory.push({pathname:(0,n.getEditProjectLink)(e,a),state:{data:t}})},goToCompanySettings:function(){window.location="/profile/settings/#/company"},openCompanyModal:function(){this.setState({companyModalOpen:!0})},closeCompanyModal:function(){this.setState({companyModalOpen:!1},this.setCompanyState)},render:function(){var e=this,t=this.props.params.projectId,a=this.state,s=a.data.company,o=a.budgetType,r=a.formFields,i=a.isSending,n=a.isLoading,p=a.formError,d=a.apiError,y=a.companyModalOpen;if(n)return React.createElement(l["default"],null);var b=!!t,j=!s&&function(){var t=React.createElement("div",{className:"editProject-modal-footer"},React.createElement(f["default"],{buttonType:"secondary",shrink:!0,onClick:e.closeCompanyModal},"Nevermind"),React.createElement(f["default"],{shrink:!0,onClick:e.goToCompanySettings},"Add my company"));return React.createElement(h.Modal,{open:y,onClose:e.closeCompanyModal,className:"editProject-companyModal",footer:t},React.createElement("h2",null,"You need a company to offer equity compensation."),React.createElement("p",null,"Have a company? Add it to your account settings page."))}(),v=("cash"===o||"cash-equity"===o)&&React.createElement(m.Input,{config:r.cash,prefix:"$",suffix:".00",inputDisabled:i}),E=("equity"===o||"cash-equity"===o)&&React.createElement(m.Input,{config:r.equity,suffix:"%",inputDisabled:i}),q=p&&React.createElement(g.FormError,null,"Please fix the errors above and try again."),P=d&&React.createElement(g.ApiError,{error:d});return React.createElement("div",{className:"editProject"},React.createElement(u["default"],{currentStep:"budget",isEditing:b,onSelection:this.goToStep}),React.createElement("div",{className:"editProject-headcap"},React.createElement("h2",null,"What is your budget for this project?"),React.createElement("p",{className:"light large"},"Budget terms will be visible on your public project page. Donâ€™t forget to account for the ",React.createElement("span",{className:"brand"},"$",c.settings.connectionBasePrice)," Loom fee to connect with each freelancer when determining your budget.")),React.createElement("div",{className:"editProject-compensation"},React.createElement(m.RadioGroup,{config:r.compensationType,className:"editProject-compensationType",inputDisabled:i}),React.createElement("div",{className:"editProject-compensationInput"},v,E)),q,P,React.createElement(f["default"],{size:"large",onClick:this.submitBudget,isLoading:i,disabled:n||i||p},"Save project & continue"),j)}});t["default"]=b},"./app/scripts/containers/editProject/editProject.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitQuestionsData=t.submitProjectData=t.getProjectData=t.getEditProjectLink=t.createEmptyProjectState=void 0;var s=a("./app/scripts/store/api.js"),o=a("./app/scripts/utils/formUtils.js"),r={projectId:null,data:{company:"",project_manager:null,skills:[],title:"",type:"",start_date:"",end_date:"",estimated_cash:"",estimated_equity_percentage:"",mix:!1,short_blurb:"",project_image:null,background:"",progress:"",scope:"",milestones:"",specs:"",private_info:"",published:!1,freelancerType:"",questions:[]},budgetType:"",apiError:!1,formError:!1,isSending:!1,isLoading:!0,profileIncomplete:!0,profile:{}};t.createEmptyProjectState=function(e){var t=Object.assign({},r);return e&&(t.data.project_manager=e.user_id,t.data.company=e.company_id),t},t.getEditProjectLink=function(e,t){return t?"/project/edit/"+t+"/"+e:"/project/create/"+e},t.getProjectData=function(e,t,a){if(e){var o=s.api.project(e),r=[o,t,a];s.get.apply(void 0,r)}else console.error("`getProjectData` method expects a projectId, a successCallback and an errorCallback.")},t.submitProjectData=function(e,t,a){if(e&&t&&a){var r=s.api.project();e.id&&(r=s.api.project(e.id));var i=[r,(0,o.objectToFormData)(e),t,a];e.id?s.patch.apply(void 0,i):s.post.apply(void 0,i)}else console.error("`submitProjectData` method expects a data object, a successCallback and an errorCallback.")},t.submitQuestionsData=function(e,t,a){if(e&&t&&a){var o=s.api.questions,r=[o,e,t,a];s.patch.apply(void 0,r)}else console.error("`submitQuestionsData` method expects a data object, a successCallback and an errorCallback.")}},"./app/scripts/containers/editProject/progressBar.jsx":function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a("./node_modules/classnames/index.js"),r=s(o),i={basics:{displayName:"Basics",isEnabled:!1,isActive:!1,isCompleted:!0},budget:{displayName:"Budget",isEnabled:!1,isActive:!1,isCompleted:!0},details:{displayName:"Details",isEnabled:!1,isActive:!1,isCompleted:!0},questions:{displayName:"Proposal Questions",isEnabled:!1,isActive:!1,isCompleted:!0}},n=React.createClass({displayName:"ProgressBar",propTypes:{currentStep:React.PropTypes.string.isRequired,onSelection:React.PropTypes.func.isRequired,isEditing:React.PropTypes.bool},getDefaultProps:function(){return{isEditing:!1}},getInitialState:function(){return{steps:i}},configureState:function(){var e=this.props,t=e.currentStep,a=e.isEditing,s=this.state.steps,o=Object.keys(i),r=o.indexOf(t);o.forEach(function(e,t){var o=s[e];o.isEnabled=t<=r||a,o.isActive=t===r,o.isCompleted=t<r||a}),this.setState({steps:s})},componentWillMount:function(){this.configureState()},goToStep:function(e){var t=this.props.onSelection,a=this.state.steps,s=a[e],o=s.isActive,r=s.isEnabled;r&&!o&&t(e)},render:function(){var e=this,t=this.state.steps,a=Object.keys(i),s=a.map(function(a,s){var o=t[a],i=o.displayName,n=o.isEnabled,c=o.isActive,p=o.isCompleted,l=function(){e.goToStep(a)},d=(0,r["default"])("progressBar-item",{"progressBar-item--complete":p,"progressBar-item--active":c,"progressBar-item--disabled":!n}),u=s+1,m=!p||c?u:React.createElement("i",{className:"fa fa-check","aria-hidden":"true"});return React.createElement("a",{className:d,key:s,onClick:l},React.createElement("div",{className:"progressBar-item-dot"},m)," ",i)});return React.createElement("div",{className:"progressBar"},s)}});t["default"]=n}});
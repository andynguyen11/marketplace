webpackJsonp([6],{"./app/scripts/containers/editProject/budget.jsx":function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a("./node_modules/react-router/es6/index.js"),i=a("./app/scripts/utils/formUtils.js"),s=a("./app/scripts/utils/elementUtils.js"),n=a("./app/scripts/containers/editProject/editProject.js"),c=a("./app/scripts/config.js"),p=a("./app/scripts/components/loader/loader.jsx"),d=r(p),l=a("./app/scripts/containers/editProject/progressBar.jsx"),m=r(l),u=a("./app/scripts/components/forms/formFields.js"),f=a("./app/scripts/components/button/button.jsx"),g=r(f),y=a("./app/scripts/components/errors/errors.js"),h=a("./app/scripts/components/modal/modal.jsx"),b=React.createClass({displayName:"ProjectBudget",propTypes:{user:React.PropTypes.object,params:React.PropTypes.object.isRequired,router:React.PropTypes.object,location:React.PropTypes.object.isRequired},getInitialState:function(){var e=this.props,t=e.user,a=e.params.projectId,r=(0,n.createEmptyProjectState)(t,a);return Object.assign({},r,{companyModalOpen:!1})},formFields:function(e){var t=this,a=e;return{compensationType:{name:"compensationType",label:"Budget type (select one)",value:function(){var e=a.estimated_cash,t=a.estimated_equity_percentage,r=a.mix,o="",i=t?t:"";return e&&i.length?o=r?"cash-and-equity":"cash-or-equity":(e&&(o="cash"),i.length&&(o="equity")),o}(),options:[{label:"Cash only",id:"cash"},{label:"Equity only",id:"equity"},{label:"Cash or equity",id:"cash-or-equity"},{label:"Cash + equity mix",id:"cash-and-equity"}],error:!1,validator:function(e){var a=t.state.formFields,r=i.FormUtils.checks.isRequired(e);return r||(a.compensationType.error="Please tell us how you'd like to compensate developers.",t.setState({formFields:a})),r},onChange:function(e){var a=t.state,r=a.budgetType,o=a.data,i=a.formFields,s=r,n=!1;switch(e){case"cash-or-equity":s="cash-equity",o.mix=!1;break;case"cash-and-equity":s="cash-equity",o.mix=!0;break;case"cash":s="cash",o.mix=!1,i.equity.onChange("");break;case"equity":s="equity",o.mix=!1,i.cash.onChange("")}o.company||"cash"===e||(n=!0),i.compensationType.value=e,i.compensationType.error=!1,t.setState({budgetType:s,data:o,formFields:i,formError:!1,companyModalOpen:n})}},cash:{name:"cash",label:"Cash budget",value:a.estimated_cash&&a.estimated_cash+""||"",error:!1,validator:function(e){var a=t.state,r=a.budgetType,o=a.formFields,i="string"==typeof e?e.replace(/,/g,""):e,s=parseInt(i),n=e.toString().match(/^\d*?\d*$/),c="cash"!==r&&"cash-equity"!==r||"number"==typeof s&&s>0&&n;return c||(o.cash.error="Please enter a cash offer.",t.setState({formFields:o})),c},onChange:function(e){var a=t.state,r=a.data,o=a.formFields;r.estimated_cash=e,o.cash.value=e,o.cash.error=!1,t.setState({data:r,formFields:o,formError:!1})}},equity:{name:"equity",label:"Equity budget",value:a.estimated_equity_percentage&&a.estimated_equity_percentage+""||"",error:!1,validator:function(e){var a=t.state,r=a.budgetType,o=a.formFields,i=parseFloat(e),s=e?e.toString().match(/^\d*\.?\d*$/):"",n="equity"!==r&&"cash-equity"!==r||"number"==typeof i&&i>0&&i<100&&s;return n||(o.equity.error="Please enter an equity offer.",t.setState({formFields:o})),n},onChange:function(e){var a=t.state,r=a.data,o=a.formFields;r.estimated_equity_percentage=e,o.equity.value=e,o.equity.error=!1,t.setState({data:r,formFields:o,formError:!1})}}}},componentWillMount:function(){var e=this,t=this.props,a=t.router,r=t.location.state,o=t.params.projectId;if(o)(0,n.getProjectData)(o,function(t){var a=Object.assign({},t),r=e.formFields(a),o="";o="cash-or-equity"===r.compensationType.value||"cash-and-equity"===r.compensationType.value?"cash-equity":r.compensationType.value,e.setState({data:a,budgetType:o,formFields:r,isLoading:!1},e.setCompanyState)},function(t,a){console.error(t),e.setState({isSending:!1,apiError:a.text})});else if(r&&r.data){var i=Object.assign({},r.data),s=this.formFields(i),c="";c="cash-or-equity"===s.compensationType.value||"cash-and-equity"===s.compensationType.value?"cash-equity":s.compensationType.value,this.setState({data:i,budgetType:c,formFields:s,isLoading:!1},this.setCompanyState)}else a.replace("/")},componentDidMount:function(){(0,s.scrollToTop)()},setCompanyState:function(){var e=this.state,t=e.data.company,a=e.formFields;t||a.compensationType.onChange("cash")},submitBudget:function(){var e=this,t=this.state,a=t.data,r=t.formFields;i.FormUtils.validateForm(r,function(t){if(e.setState({formError:!t,apiError:!1}),t){e.setState({isSending:!0});var r=Object.assign({},a);delete r.project_image,r.published=!0,(0,n.submitProjectData)(r,function(t){e.goToStep("details",t)},function(t,a){console.error(t),e.setState({isSending:!1,apiError:a.text})})}})},goToStep:function(e,t){var a=this.props.params.projectId;o.browserHistory.push({pathname:(0,n.getEditProjectLink)(e,a),state:{data:t}})},goToCompanySettings:function(){window.location="/profile/settings/#/company"},openCompanyModal:function(){this.setState({companyModalOpen:!0})},closeCompanyModal:function(){this.setState({companyModalOpen:!1},this.setCompanyState)},render:function(){var e=this,t=this.props.params.projectId,a=this.state,r=a.data.company,o=a.budgetType,i=a.formFields,s=a.isSending,n=a.isLoading,p=a.formError,l=a.apiError,f=a.companyModalOpen;if(n)return React.createElement(d["default"],null);var b=!!t,j=!r&&function(){var t=React.createElement("div",{className:"editProject-modal-footer"},React.createElement(g["default"],{buttonType:"secondary",shrink:!0,onClick:e.closeCompanyModal},"Nevermind"),React.createElement(g["default"],{shrink:!0,onClick:e.goToCompanySettings},"Add my company"));return React.createElement(h.Modal,{open:f,onClose:e.closeCompanyModal,className:"editProject-companyModal",footer:t},React.createElement("h2",null,"You need a company to offer equity compensation."),React.createElement("p",null,"Have a company? Add it to your account settings page."))}(),x=("cash"===o||"cash-equity"===o)&&React.createElement(u.Input,{config:i.cash,prefix:"$",suffix:".00",inputDisabled:s}),v=("equity"===o||"cash-equity"===o)&&React.createElement(u.Input,{config:i.equity,suffix:"%",inputDisabled:s}),P=p&&React.createElement(y.FormError,null,"Please fix the errors above and try again."),E=l&&React.createElement(y.ApiError,{error:l});return React.createElement("div",{className:"editProject"},React.createElement(m["default"],{currentStep:"budget",isEditing:b,onSelection:this.goToStep}),React.createElement("div",{className:"editProject-headcap"},React.createElement("h2",null,"What is your budget for this project?"),React.createElement("p",{className:"light large"},"Budget terms will be visible on your public project page. Donâ€™t forget to account for the ",React.createElement("span",{className:"brand"},"$",c.settings.connectionBasePrice)," Loom fee to connect with each freelancer when determining your budget.")),React.createElement("div",{className:"editProject-compensation"},React.createElement(u.RadioGroup,{config:i.compensationType,className:"editProject-compensationType",inputDisabled:s}),React.createElement("div",{className:"editProject-compensationInput"},x,v)),P,E,React.createElement(g["default"],{size:"large",onClick:this.submitBudget,isLoading:s,disabled:n||s||p},"Save project & continue"),j)}});t["default"]=b},"./app/scripts/containers/editProject/editProject.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitQuestionsData=t.submitProjectData=t.getProjectData=t.getEditProjectLink=t.createEmptyProjectState=void 0,a("./app/scripts/containers/editProject/editProject.scss");var r=a("./app/scripts/store/api.js"),o=a("./app/scripts/utils/formUtils.js"),i={projectId:null,data:{company:"",project_manager:null,skills:[],title:"",type:"",start_date:"",end_date:"",estimated_cash:"",estimated_equity_percentage:"",mix:!1,short_blurb:"",project_image:null,background:"",progress:"",scope:"",milestones:"",specs:"",private_info:"",published:!1,freelancerType:"",questions:[]},budgetType:"",apiError:!1,formError:!1,isSending:!1,isLoading:!0,profileIncomplete:!0,profile:{}};t.createEmptyProjectState=function(e){var t=Object.assign({},i);return e&&(t.data.project_manager=e.user_id,t.data.company=e.company_id),t},t.getEditProjectLink=function(e,t){return t?"/project/edit/"+t+"/"+e:"/project/create/"+e},t.getProjectData=function(e,t,a){if(e){var o=r.api.project(e),i=[o,t,a];r.get.apply(void 0,i)}else console.error("`getProjectData` method expects a projectId, a successCallback and an errorCallback.")},t.submitProjectData=function(e,t,a){if(e&&t&&a){var i=r.api.project();e.id&&(i=r.api.project(e.id));var s=[i,(0,o.objectToFormData)(e),t,a];e.id?r.patch.apply(void 0,s):r.post.apply(void 0,s)}else console.error("`submitProjectData` method expects a data object, a successCallback and an errorCallback.")},t.submitQuestionsData=function(e,t,a){if(e&&t&&a){var o=r.api.questions,i=[o,e,t,a];r.patch.apply(void 0,i)}else console.error("`submitQuestionsData` method expects a data object, a successCallback and an errorCallback.")}},"./app/scripts/containers/editProject/editProject.scss":function(e,t,a){t=e.exports=a("./node_modules/css-loader/lib/css-base.js")(),t.push([e.i,".editProject{max-width:768px;min-width:320px;width:100%;margin:auto;padding-right:20px;padding-left:20px;padding-bottom:40px}.editProject .button--large{display:block;margin-left:auto}.editProject-headcap{text-align:center;margin:40px 0}.editProject-selectDates{display:flex;justify-content:space-between;flex-wrap:wrap}.editProject-selectDates .form-set{margin-top:0;flex-basis:49%}@media (max-width:480px){.editProject-selectDates .form-set{flex-basis:100%}}.editProject-attachImage-requirements{text-align:center;padding:20px 0}.editProject-attachImage-requirements .form-input-error{display:inline-flex;margin:auto}.editProject-attachImage-preview{width:100%;position:relative;border:3px dashed #dad9dd;padding:5px;margin-bottom:20px;display:flex;flex-direction:column;align-items:center}.editProject-attachImage-preview:hover{border-color:#c8c6cc;opacity:.8}.editProject-attachImage-preview img{width:100%}.editProject-attachImage-preview input[type=file],.editProject-attachImage-preview input[type=file]:before{position:absolute;top:0;left:0;right:0;bottom:0;cursor:pointer;width:100%;height:100%;opacity:0}.editProject-attachImage-preview input[type=file]:before{content:'';z-index:10}.editProject-attachImage-preview-filename{font-weight:700;padding:5px 0 0}.editProject-companyModal .modal-message{text-align:center}@media (min-width:768px){.editProject-companyModal .modal-message{padding:0 60px}}.editProject-companyModal p{margin-bottom:20px}.editProject-modal-footer{display:flex;align-items:center;flex-wrap:wrap;width:100%;justify-content:flex-end;padding:10px}.editProject-modal-footer .button{flex-shrink:0}.editProject-modal-footer .button+.button{margin-left:10px}.editProject-compensationType{display:flex;flex-wrap:wrap;flex-basis:50%}.editProject-compensationType .form-set--radio-item,.editProject-compensationType>.form-label{flex-basis:100%}@media (max-width:768px){.editProject-compensationType{flex-basis:100%}}.editProject-compensationInput{max-width:200px}.progressBar{display:flex;justify-content:center;margin:40px auto}@media (max-width:480px){.progressBar{transform:scale(.7)}}.progressBar .progressBar-item{border:2px solid #ff7b5c;font-weight:700;text-transform:capitalize;display:flex;align-items:center;padding:10px 15px}@media (max-width:480px){.progressBar .progressBar-item{padding:10px}}.progressBar .progressBar-item .progressBar-item-dot{width:20px;height:20px;text-align:center;border-radius:50%;color:#ff7b5c;background:#ffe5df;line-height:1;display:flex;align-items:center;justify-content:center;font-size:12px;margin-right:7px;flex-shrink:0}.progressBar .progressBar-item+.progressBar-item{border-left:none}.progressBar .progressBar-item:first-of-type{border-radius:5px 0 0 5px}.progressBar .progressBar-item:last-of-type{border-radius:0 5px 5px 0}.progressBar .progressBar-item.progressBar-item--complete{background:#f4dbd5;color:#ff7b5c}.progressBar .progressBar-item.progressBar-item--complete .progressBar-item-dot{background:#ff7b5c;color:#fff}.progressBar .progressBar-item.progressBar-item--active{background:#ff7b5c;color:#f3f3f3;cursor:default}.progressBar .progressBar-item.progressBar-item--active .progressBar-item-dot{color:#ff7b5c;background:#ffe5df}.progressBar .progressBar-item.progressBar-item--disabled{background:#fff;color:#ff7b5c;cursor:default}.editProject-completeProfile{max-width:100%;width:768px;margin:60px auto}",""])},"./app/scripts/containers/editProject/progressBar.jsx":function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a("./node_modules/classnames/index.js"),i=r(o),s={basics:{displayName:"Basics",isEnabled:!1,isActive:!1,isCompleted:!0},budget:{displayName:"Budget",isEnabled:!1,isActive:!1,isCompleted:!0},details:{displayName:"Details",isEnabled:!1,isActive:!1,isCompleted:!0},questions:{displayName:"Proposal Questions",isEnabled:!1,isActive:!1,isCompleted:!0}},n=React.createClass({displayName:"ProgressBar",propTypes:{currentStep:React.PropTypes.string.isRequired,onSelection:React.PropTypes.func.isRequired,isEditing:React.PropTypes.bool},getDefaultProps:function(){return{isEditing:!1}},getInitialState:function(){return{steps:s}},configureState:function(){var e=this.props,t=e.currentStep,a=e.isEditing,r=this.state.steps,o=Object.keys(s),i=o.indexOf(t);o.forEach(function(e,t){var o=r[e];o.isEnabled=t<=i||a,o.isActive=t===i,o.isCompleted=t<i||a}),this.setState({steps:r})},componentWillMount:function(){this.configureState()},goToStep:function(e){var t=this.props.onSelection,a=this.state.steps,r=a[e],o=r.isActive,i=r.isEnabled;i&&!o&&t(e)},render:function(){var e=this,t=this.state.steps,a=Object.keys(s),r=a.map(function(a,r){var o=t[a],s=o.displayName,n=o.isEnabled,c=o.isActive,p=o.isCompleted,d=function(){e.goToStep(a)},l=(0,i["default"])("progressBar-item",{"progressBar-item--complete":p,"progressBar-item--active":c,"progressBar-item--disabled":!n}),m=r+1,u=!p||c?m:React.createElement("i",{className:"fa fa-check","aria-hidden":"true"});return React.createElement("a",{className:l,key:r,onClick:d},React.createElement("div",{className:"progressBar-item-dot"},u)," ",s)});return React.createElement("div",{className:"progressBar"},r)}});t["default"]=n}});
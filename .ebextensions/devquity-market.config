packages:
  yum:
    postgresql93-devel: []
    libffi-devel: []

container_commands:
  01_node_install:
    command: 'yum install -y nodejs npm --enablerepo=epel'
  02_npm_install_gulp:
    command: 'sudo npm install -g gulp-cli'
  03_migrate:
    command: "python manage.py migrate --noinput"
    leader_only: true
  04_run_front_end_build:
    command: "npm install && gulp"
  05_collectstatic:
    command: "python manage.py collectstatic --noinput"

option_settings:
  - namespace: aws:elasticbeanstalk:container:python
    option_name: WSGIPath
    value: market/wsgi.py
  - namespace: aws:elasticbeanstalk:container:python:staticfiles
    option_name: /static/
    value: static/
  - option_name: DJANGO_SETTINGS_MODULE
    value: market.settings
  - option_name: AWS_STORAGE_BUCKET_NAME
    value: devquity
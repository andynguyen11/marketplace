{% extends 'base.html' %}
{% load staticfiles %}
{% load cache %}
{% load thumbnail %}

{% block content %}
  {% cache 3600 projects ENVIRONMENT type %}
  <div id="discover">
    <h1>Discover a project that inspires you.</h1>
    <div class="discover-nav">
      <h2>
        <span>show me</span>
        <div class="dropdown">
          <button onclick="dropdown()" class="dropbtn underline-text">
            <span class="discover-underline">{{ type }}</span>
            <i class="fa fa-angle-down"></i>
          </button>
          <div id="myDropdown" class="dropdown-content">
            {% for cat, name in project_types %}
              <a class="dropdown-item text-lowercase" href="{% url 'project-gallery' cat %}">
                {{ name }}
              </a>
            {% endfor %}
            <a class="dropdown-item" href="{% url 'project-gallery' 'all' %}">all</a>
          </div>
        </div>
        <span id="disc-project-sub" class="hide-mobile">projects</span>
      </h2>
    </div>

    <div class="page-content--alternate">

    {% if new %}
      <div class="plates page-content--medium">
        <div class="plates-headcap">
          <h3 class="plates-header brand-bold">{{ type }} projects</h3>
        </div>
        <div class="plates-inner projectCards projectCards-discover">
          {% for project in new %}
            {% include 'projectCard.html' with project=project %}
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="page-content--medium">
        <div class="plates page-content--medium">
          <div class="plates-headcap">
            <h3 class="plates-header brand-bold">All Projects</h3>
          </div>
          <div class="plates-inner projectCards projectCards-discover">
            {% for project in all %}
              {% include 'projectCard.html' with project=project %}
            {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}
    </div>
  </div>
  {% endcache %}
{% endblock %}

{% block scripts %}
  <script type="text/javascript">
    function dropdown(event) {
      document.getElementById("myDropdown").classList.toggle("show");
    }

    window.onclick = function(event) {
      if (!event.target.matches('.dropbtn')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    }
  </script>
{% endblock scripts %}

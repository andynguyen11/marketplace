{% extends "base_account.html" %}
{% load staticfiles %}

{% block account_content %}
<div id="dashboard">
  <div class="row">
    <div class="container">
      <div class="dashboard-tables">
        <h2>Manage your projects</h2>

        {% if projects %}
          {% for project in projects %}
          <div class="section">
            <div class="section-header section-header--projects">
              <a href="{% url 'project' project.slug %}">{{ project.title }}</a>
              <div class="action-buttons">
                <a href="{% url 'edit-project' %}{{ project.id }}" class="btn btn-brand btn-sm">Edit</a>
                <a href="{% url 'delete-project' project.id %}" onclick="return confirm('Are you sure ?')" class="btn btn-brand btn-sm">Remove</a>
              </div>
            </div>
            {% if project.job_set.all %}
              <table class="dashboard-table dashboard-table-flex">
                <thead class="hide-mobile">
                  <tr>
                    <th></th>
                    <th>Name</th>
                    <th>Cash</th>
                    <th>Equity</th>
                    <th>Est. Hours</th>
                    <th>Submitted</th>
                    <th></th>
                  </tr>
                </thead>
                {% for bid in project.job_set.all %}
                <tr>
                  <td>
                    <div class="profile-photo" style="background-image: url(https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&resize_w=200&url={{ bid.contractor.get_photo }})"></div>
                  </td>
                  <td>
                    <strong>{{ bid.contractor.first_name }}</strong>
                  </td>
                  <td class="hide-mobile">
                    <strong>{% if bid.cash %}${{ bid.cash }}{% endif %}</strong>
                  </td>
                  <td class="hide-mobile">
                    <strong>{% if bid.equity %}{{ bid.equity }}%{% endif %}</strong>
                  </td>
                  <td class="hide-mobile">
                    <strong>{{ bid.contractor.capacity }} hours/wk</strong>
                  </td>
                  <td class="dashboard-table-flex-expand">
                    {{ bid.date_created }}
                  </td>
                  <td>
                    {% if bid.conversation %}
                      <a href="{% url 'view-conversation' thread_id=bid.conversation.id %}" class="btn btn-brand--clear pull-right">View Messages</a>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
                </table>
              {% else %}
                <table class="dashboard-table">
                  <tbody>
                    <tr>
                      <td>
                        <h5 style="text-align: center;">There are currently no bids on this project.
                        {% comment %}
                        <a href="{% url 'discover-developers' 'all' %}">Start searching</a> for some developers!</h5>
                        {% endcomment %}
                      </td>
                    </tr>
                  </tbody>
                </table>
              {% endif %}
          </div>
        {% endfor %}
        {% else %}
          <div class="section">
            <div class="section-header section-header--projects">
              Projects (0)
            </div>
            <div class="projectsTab-empty text-center">
              <p>You don't have any pending projects.</p>
              <a href="{% url 'create-project' %}" class="btn btn-lg btn-brand">Post your project</a>
            </div>
          </div>
        {% endif %}
      </div>

    </div>
  </div>
</div>


{% endblock %}